\ProvidesPackage{general_preamble}

% DOCUMENT STYLE
\usepackage[a4paper,
  left=2cm, right=2cm, top=2.7cm, bottom=2.5cm,
  headsep=\dimexpr2.5cm-55pt\relax,
  headheight=55pt]{geometry}
\linespread{1.5}                                    % regulate line spacing
\usepackage{setspace}
\usepackage[parfill]{parskip}                       % remove indentation of first line
\usepackage[T1]{fontenc}
\usepackage{soul}
\usepackage{xcolor}
\usepackage{enumitem}

% FONTS
\usepackage{fontspec}
\setmainfont{RobotoSerif}[
  Path = ./font/ ,
  Extension = .ttf ,
  UprightFont = *-Regular ,
  ItalicFont = *-Italic ,
  BoldFont = *-Bold ,
  BoldItalicFont = *-BoldItalic
]

% package to generate random textcomp
\usepackage{blindtext}

% FORMAT HEADERS AND FOOTERS
\usepackage{fancyhdr}
\pagestyle{fancy} % page style to fancy to print header
\rhead{\footnotesize \emph{Last update}: \today}
\lhead{\footnotesize \em \nouppercase{\leftmark{} -- \rightmark}}

% CHEMICAL FORMULAE AND SPECIAL SYMBOLS
\usepackage[version=4]{mhchem}
\usepackage{textcomp}
\usepackage{siunitx}
\sisetup{
  detect-all = true,                                    % detect and follow surrounding font changes
  range-phrase= --, range-units = single,               % set range format
  per-mode = symbol,                                    % set "/" as format for fraction units
  uncertainty-mode = separate,                          % seprate uncertainty (+-) from number
  separate-uncertainty-units = single,                  % put units only after uncertainty
  group-digits = integer,                               % apply digit grouping just for the integer part 
  group-separator = {,},                                % separator between digits
  group-minimum-digits = 4,                             % set the minimun number of digits to apply goruping to 4
  bracket-unit-denominator = false,                     % do not put brackets in denominator
  list-units = single,                                  % in list mode, put units only at the end
  exponent-mode = threshold,                            % automatically typeset with scientific notation (default threshold of -3:3)
  print-unity-mantissa = false                          % do not print mantissa if it is 1
  %round-mode = places,
  %round-precision = 3
  }
\DeclareSIUnit{\nothing}{\relax}                  % define unit to typset just prefixes
\DeclareSIUnit{\molar}{M}                         % define unit for molar cocnentration (M)

\newcommand{\per}{$\times$}
\newcommand{\NA}{--}
\newcommand{\doublecurlyquotes}[1]{“#1”}
\newcommand{\singlecurlyquotes}[1]{‘#1’}
\newcommand{\curlyapostrophe}{’}

% percentages
\newcommand{\hundredpercent}{\qty{100}{\percent}}
\newcommand{\fivepercent}{\qty{5}{\percent}}
\newcommand{\onepercent}{\qty{1}{\percent}}
\newcommand{\zeroonepercent}{\qty{0.1}{\percent}}

% volumes
\newcommand{\twohunmicrol}{\qty{200}{\ul}}
\newcommand{\fivehunmicrol}{\qty{500}{\ul}}
\newcommand{\onemil}{\qty{1}{\ml}}

% temperatures
\newcommand{\fourdegree}{\qty{4}{\degreeCelsius}}
\newcommand{\thirtysevendegree}{\qty{37}{\degreeCelsius}}
\newcommand{\minustwenty}{\qty{-20}{\degreeCelsius}}

% time
\newcommand{\tenmin}{\qty{10}{\minute}}
\newcommand{\quarter}{\qty{15}{\minute}}
\newcommand{\halfhour}{\qty{30}{\minute}}

% reagents
\newcommand{\pbs}{\num{1}\per{} PBS}
\newcommand{\hs}{\num{0.25}\per{} HS}
\newcommand{\ssct}{\num{5}\per{} SSCT}

% others
\newcommand{\qtytimes}[3]{#1 \per{} \qty{#2}{#3}}
\newcommand{\noexponentnum}[1]{\num[exponent-mode = fixed, fixed-exponent = 0]{#1}}

% DATES
\usepackage[datesep=/, calc, en-GB]{datetime2}
\usepackage{fmtcount}

% define the style for CV, that is: Jan 1st, 2024
\DTMnewdatestyle{cvdateformat}{%
  \renewcommand{\DTMdisplaydate}[4]{%
  \DTMshortmonthname{##2} \protect\ordinalnum{##3}, \number##1 }%
  \renewcommand{\DTMDisplaydate}{\DTMdisplaydate}%
}

% GLOSSARIES, ACRONYMS, AND ABBREVIATIONS
\usepackage[acronym, nonumberlist, toc, nomain, nopostdot, shortcuts]{glossaries-extra}
%\loadglsentries{sections/abbreviations}	
% define command to print brackets when first usage is within parenthesis
\newcommand*{\pac}[2][]{\ifglsused{#2}{\acs[#1]{#2}}{%
 \glsunset{#2}%
 \acl[#1]{#2} [\acs[#1]{#2}]}}

% DEFINE TITLE STYLES
\renewcommand\maketitle{
{\begin{center}
{\Large \bfseries \@title }\\
{\small \emph{First created}: \DTMdisplaydate{2024}{12}{5}{-1}\hfill%
\setstretch{1.0} \small \hfill \emph{Last update}: \today}\\[2ex]
%{\Large  \@author}\\[4ex] 
\end{center}}} % Note the extra }

\usepackage{titlesec}
%\titleformat{⟨command⟩}[⟨shape⟩]{⟨format⟩}{⟨label⟩}{⟨sep⟩}{⟨before-code⟩}[⟨after-code⟩]
\titleformat{\section}{\large\bfseries\uppercase}{\thesection}{}{\centering}
\titleformat{\subsection}{\normalsize\bfseries}{\thesubsection}{}{}

% DEFINE BUTTON-STYLE BOXES
%\usepackage{tcolorbox}
%\tcbset{on line}

%\newcommand{\insertboxes}[3]{{\bfseries \tcbox{#1} \tcbox{#2} \tcbox{#3}}}

% DEFINE EMPHASIS LEFT RULE
\usepackage{mdframed}
\newmdenv[
  topline=false,
  bottomline=false,
  rightline=false,
  linecolor=gray
]{leftrule}
\newcommand{\alert}[1]{{\itshape \small \setstretch{1.0} \begin{leftrule} \textcolor{gray}{#1} \end{leftrule}}}

% STEP SYNTAX
% wash steps: #1=action; #2=time; #3=quantity; #4=reagent; #5=temperature
\newcommand{\step}[5]{\MakeUppercase #1 samples for \ul{#2} with #3 of \textbf{#4} at #5.}
\newcommand{\note}[1]{{\itshape \small \textcolor{gray}{Note: #1}}}